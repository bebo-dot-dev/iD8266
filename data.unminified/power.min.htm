<!DOCTYPE HTML>
<html lang="en">
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Power Management</title>
		<link href="css/bootstrap.min.css" media="all" rel="stylesheet" />
		<link href="css/app.css" media="all" rel="stylesheet" />
	</head>
	<body>
		<div class="container">
			<nav class="navbar navbar-default">
				<div class="container-fluid">
					<div class="navbar-header">
						<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
							<span class="sr-only">Toggle navigation</span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
						</button>
						<a class="navbar-brand" href="/"> Power Management </a>
					</div>
					<div id="navbar" class="navbar-collapse collapse">
						<ul class="navbar-nav list-inline">
							<li>
								<a href="/">
								<button type="button" class="btn btn-default navbar-btn">
									Home
								</button></a>
							</li>
							<li>
								<a href="/logoff">
								<button type="button" class="btn btn-default navbar-btn">
									Log Off
								</button></a>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div><!--/.container-fluid -->
			</nav>
			<div id="loading" class="alert alert-success" role="alert"><strong>Please wait</strong> loading settings...</div>
			<div id="mainPnl" class="panel panel-default dnone">
				<div class="panel-body">				
					<form id="powerFrm" method='post' enctype='multipart/form-data' autocomplete='off'>
						<div id="generalSaveSuccess" class="form-group dnone">
							<div class="alert alert-success" role="alert"> 
								<strong>Done!</strong> Settings saved and activated 
							</div>
						</div>
						<div class="form-group">
							<div class="formCtrl">
								<label for="enabled">Enable Power Management</label>
								<input type="checkbox" class="form-control" id="enabled" name="enabled" >
							</div>
							<a role="button" tabindex="0" data-trigger="focus" class="info" data-po="po" title="Power Management" data-placement="bottom" data-html="true" data-content="Enable / disable deep sleep power management features.<br/><br/>A physical device hard restart will always override any deep sleep configuration, enabling the device to remain powered on for a minimum of 5 minutes"> <span>i</span> </a>
						</div>
						<div class="panel panel-default dnone pwrMgmtPnl">							
							<div class="panel-heading" data-toggle="collapse" data-target="#generalParamSection">
								<h3 class="panel-title">Automation</h3>
							</div>
							<div id="generalParamSection" class="panel-body collapse">								
							<div class="form-group">
									<div class="formCtrl">
										<label for="onLength">Power On Length</label>
										<select class="form-control" id="onLength" name="onLength">
											<option value="0">Continuous</option>
											<option value="1">Single Cycle</option>
											<option value="2">One Minute</option>
											<option value="3">Two Minutes</option>
											<option value="4">Five Minutes</option>
											<option value="5">Fifteen Minutes</option>
										</select>
									</div>
									<a role="button" tabindex="0" data-trigger="focus" class="info" data-po="po" title="Power On Length" data-placement="bottom" data-html="true" data-content="Configure the length of time the device is powered on for before deep sleep is automatically initiated.<br/><br/>Continuous: No automated sleep<br/><br/>Single Cycle: Sleep as soon as possible"> <span>i</span> </a>
								</div>
								<div class="form-group">
									<div class="formCtrl">
										<label for="offLength">Power Off Length</label>
										<select class="form-control" id="offLength" name="offLength">
											<option value="0">5 minutes</option>
											<option value="1">30 minutes</option>
											<option value="2">1 hour</option>
											<option value="3">3 hours</option>
											<option value="4">6 hours</option>
											<option value="5">8 hours</option>
											<option value="6">12 hours</option>
											<option value="7">16 hours</option>
											<option value="8">20 hours</option>
											<option value="9">24 hours</option>
										</select>
									</div>
									<a role="button" tabindex="0" data-trigger="focus" class="info" data-po="po" title="Power Off Length" data-placement="bottom" data-content="Configure the length of time the device will remain powered down in deep sleep mode"> <span>i</span> </a>								    
								</div>								
								<div class="panel panel-default">
									<div class="panel-heading" data-toggle="collapse" data-target="#loggingSection">
										<h3 class="panel-title">Logging</h3>
									</div>	
									<div id="loggingSection" class="panel-body collapse">
										<div class="form-group">
											<div class="formCtrl">
												<label for="logToThingSpeak">Enable ThingSpeak</label>
												<input type="checkbox" class="form-control" id="logToThingSpeak" name="LogToThingSpeak" >
											</div>
											<a role="button" tabindex="0" data-trigger="focus" class="info" data-po="po" title="Enable ThingSpeak" data-placement="bottom" data-html="true" data-content="Enables/disables power event logging to ThingSpeak for this device.<br/><br/>See&nbsp;<a href='https://thingspeak.com/' target='_blank'>ThingSpeak</a>&nbsp;for details"> <span>i</span> </a>
										</div>
										<div class="thingspeak dnone">
											<div class="form-group">
												<div class="formCtrl">
													<label for="thingSpeakChannel">ThingSpeak Channel</label>
													<input type="text" class="form-control w100 number" id="thingSpeakChannel" name="ThingSpeakChannel" maxlength="32" >
												</div>
												<a role="button" tabindex="5" data-trigger="focus" class="info" data-po="po" title="ThingSpeak Channel" data-placement="bottom" data-content="The target ThingSpeak Channel for power management event logging"> <span>i</span> </a>
											    <span id="thingSpeakChannelValFail" class="valFail">* A valid channel number is required</span>
											</div>
											<div class="form-group">
												<div class="formCtrl">
													<label for="thingSpeakApiKey">ThingSpeak API Key</label>
													<input type="text" class="form-control valtxt apiKey" id="thingSpeakApiKey" name="ThingSpeakApiKey" maxlength="32" >
												</div>
												<a role="button" tabindex="6" data-trigger="focus" class="info" data-po="po" title="ThingSpeak API Key" data-placement="bottom" data-content="The corresponding API key for the channel configured for power management event logging"> <span>i</span> </a>
											    <span id="thingSpeakApiKeyValFail" class="valFail">* A valid API key is required</span>
											</div>
										</div>								
										<div class="form-group">
											<div class="formCtrl">
												<label for="httpLoggingEnabled">Enable HTTP Logging</label>
												<input type="checkbox" class="form-control" id="httpLoggingEnabled" name="httpLoggingEnabled" >
											</div>
											<a role="button" tabindex="1" data-trigger="focus" class="info" data-po="po" title="Enable HTTP Logging" data-placement="bottom" data-html="true" data-content="Enables/disables power event logging to any web server via the HTTP protocol for this device.<br/><br/>The target host can be on the local network or the internet. It's possible to use this feature chained with other external services e.g.&nbsp;<a href='https://uk.mathworks.com/help/thingspeak/thingtweet-app.html' target='_blank'>ThingTweet</a>&nbsp;and&nbsp;<a href='https://ifttt.com/wtf' target='_blank'>IFTTT</a>&nbsp;to extend this device's range/flexibility"> <span>i</span> </a>
										</div>
										<div class="httplogging dnone">
											<div class="form-group">
												<div class="formCtrl">
													<label for="httpLoggingHost">HTTP Logging Host</label>
													<input type="text" class="form-control valtxt" id="httpLoggingHost" name="httpLoggingHost" maxlength="32" >
												</div>
												<a role="button" tabindex="1" data-trigger="focus" class="info" data-po="po" title="HTTP Logging Host" data-placement="bottom" data-content="The hostname of the server to log to e.g. api.thingspeak.com"> <span>i</span> </a>
											    <span id="httpLoggingHostValFail" class="valFail">* A valid host is required</span>
											</div>
											<div class="form-group">
												<div class="formCtrl">
													<label for="httpLoggingUri">HTTP Logging URI</label>
													<input type="text" class="form-control" id="httpLoggingUri" name="httpLoggingUri" maxlength="128" >
												</div>
												<a role="button" tabindex="2" data-trigger="focus" class="info" data-po="po" title="HTTP Logging URI" data-placement="bottom" data-html="true" data-content="The URI path to include in the request.<br/><br/>The URI can include any required query string parameters that are necessary for the request to succeed i.e. an API key / password etc.<br/><br/>e.g.&nbsp;/apps/thingtweet/1/statuses/update?key=E8L860U5PZ4LYAOD&status="> <span>i</span> </a>								    
											</div>								
										</div>
									</div>
								</div>								
							</div>																				
						</div>
						<button id="savePwrMgmtSettings" type="button" class="btn btn-default dnone">
							Submit
						</button>						
					</form>	
				</div>
				<div class="panel-body dnone pwrMgmtPnl">
					<form id="scheduleFrm" method='post' enctype='multipart/form-data' autocomplete='off'>						
						<div class="panel panel-default">							
							<div class="panel-heading" data-toggle="collapse" data-target="#scheduleSection">
								<h3 class="panel-title">Scheduling</h3>
							</div>
							<div id="scheduleSection" class="panel-body collapse">
								<div id="scheduleSaveSuccess" class="form-group dnone">
									<div class="alert alert-success" role="alert"> 
										<strong>Done!</strong> Schedules updated and activated 
									</div>
								</div>
								<div id="newScheduleSection" class="panel panel-default">
									<div class="panel-heading" data-toggle="collapse" data-target="#newSchedule">
										<h3 class="panel-title">New Schedule</h3>
									</div>		
									<div id="newSchedule" class="panel-body collapse">
										<div class="form-group">
											<div class="formCtrl">
												<label for="scheduleWeekday">Weekday</label>
												<select class="form-control" id="scheduleWeekday">
													<option value="2">Monday</option>
													<option value="3">Tuesday</option>
													<option value="4">Wednesday</option>
													<option value="5">Thursday</option>
													<option value="6">Friday</option>
													<option value="7">Saturday</option>
													<option value="1">Sunday</option>
												</select>
											</div>
											<a role="button" tabindex="0" data-trigger="focus" class="info" data-po="po" title="Weekday" data-placement="bottom" data-content="Configure the day of the week this schedule applies to"> <span>i</span> </a>
										</div>
										<div class="form-group">
											<div class="formCtrl">
												<label for="scheduleHour">Hour</label>
												<select class="form-control" id="scheduleHour">
													<option value="0">00</option>
													<option value="1">01</option>
													<option value="2">02</option>
													<option value="3">03</option>
													<option value="4">04</option>
													<option value="5">05</option>
													<option value="6">06</option>
													<option value="7">07</option>
													<option value="8">08</option>
													<option value="9">09</option>
													<option value="10">10</option>
													<option value="11">11</option>
													<option value="12">12</option>
													<option value="13">13</option>
													<option value="14">14</option>
													<option value="15">15</option>
													<option value="16">16</option>
													<option value="17">17</option>
													<option value="18">18</option>
													<option value="19">19</option>
													<option value="20">20</option>
													<option value="21">21</option>
													<option value="22" selected="selected">22</option>
													<option value="23">23</option>
												</select>
											</div>
											<a role="button" tabindex="0" data-trigger="focus" class="info" data-po="po" title="Hour" data-placement="bottom" data-content="Configure the hour of the day this schedule applies to"> <span>i</span> </a>								    
										</div>
										<div class="form-group">
											<div class="formCtrl">
												<label for="scheduleOffLength">Power Off Length</label>
												<select class="form-control" id="scheduleOffLength">
													<option value="0">5 minutes</option>
													<option value="1">30 minutes</option>
													<option value="2">1 hour</option>
													<option value="3">3 hours</option>
													<option value="4">6 hours</option>
													<option value="5" selected="selected">8 hours</option>
													<option value="6">12 hours</option>
													<option value="7">16 hours</option>
													<option value="8">20 hours</option>
													<option value="9">24 hours</option>
												</select>
											</div>
											<a role="button" tabindex="0" data-trigger="focus" class="info" data-po="po" title="Power Off Length" data-placement="bottom" data-content="Configure the length of time the device will remain powered down in deep sleep mode"> <span>i</span> </a>								    
										</div>										
										<div class="form-group">
											<div class="formCtrl">
												<br/>
												<button id="saveSchedule" type="button" class="btn btn-default">
													Submit
												</button>
											</div>
										</div>
									</div>
								</div>
								<div>
									<table id="scheduleTable" class="table table-bordered table-striped">										
								        <thead>
								        	<tr>
								        		<td>Day</td>
								        		<td>Hour</td>
								        		<td>Off Length</td>
								        		<td></td>
								        	</tr>
								        </thead>
										<tbody>
										</tbody>
									</table>
								</div>
							</div>																
						</div>						
					</form>	
				</div>
			</div>
		</div>
		<script src="js/jquery-2.2.0.min.js"></script>
		<script src="js/bootstrap.min.js"></script>
		<script src="js/jquery.mask.min.js"></script>
		<script src="js/power.js"></script>
	</body>
</html>
