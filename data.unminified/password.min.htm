<!DOCTYPE HTML>
<html lang="en">
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Security</title>
		<link href="css/bootstrap.min.css" media="all" rel="stylesheet" />
		<link href="css/app.css" media="all" rel="stylesheet" />
	</head>
	<body>
		<div class="container">
			<nav class="navbar navbar-default">
				<div class="container-fluid">
					<div class="navbar-header">	
						<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
							<span class="sr-only">Toggle navigation</span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
						</button>					
						<a class="navbar-brand" href="/"> Security </a>
					</div>
					<div id="navbar" class="navbar-collapse collapse">
						<ul class="navbar-nav list-inline">
							<li>
								<a href="/">
								<button type="button" class="btn btn-default navbar-btn">
									Home
								</button></a>
							</li>
							<li>
								<a href="/logoff">
								<button type="button" class="btn btn-default navbar-btn">
									Log Off
								</button></a>
							</li>
						</ul>
					</div><!--/.nav-collapse -->				
				</div>
			</nav>
			<div id="pleaseWait" class="alert alert-success" role="alert"><strong>Please wait</strong> loading settings...</div>
			<div id="mainPnl" class="dnone">
				<div class="panel panel-default">
					<div class="panel-heading">
				    	<h3 class="panel-title"><a href="/network">Password</a></h3>
			  		</div>
					<div class="panel-body">
						<form id="passwordFrm" method='post' action='/password' enctype='multipart/form-data' autocomplete='off'>
							<div class="form-group">
								<div class="formCtrl">
									<label for="pwd">New Password</label>
									<input type="password" class="form-control" id="pwd" name="pwd" maxlength="32" autocomplete="new-password">
								</div>
								<a role="button" tabindex="0" data-trigger="focus" class="info" data-po="po" title="Administrator Password" data-placement="bottom" data-content="Configure the administrator password for access to this device web interface."> <span>i</span> </a>							
							</div>
							<div class="form-group">
								<div class="formCtrl">
									<div class="progress pull-left">
										<div id="complexity-bar" class="progress-bar progress-bar-danger" role="progressbar" style="width: 0%;">
										</div>																						
									</div>
									<h5 class="complexity pull-left">0%</h5>																					
								</div>
								<a role="button" tabindex="1" data-trigger="focus" class="info clearfix" data-po="po" title="Password Complexity" data-placement="bottom" data-content="Displays a complexity calculation of the input password. Once valid, the bar will turn green and the password can be confirmed and saved."> <span>i</span> </a>													
							</div>						
							<div class="form-group">
								<div class="formCtrl">
									<label for="confirmPwd">Confirm Password</label>
									<input type="password" class="form-control" id="confirmPwd" name="confirmPwd" maxlength="32" autocomplete="new-password">
								</div>												
							</div>
							<button type="submit" class="btn btn-default disabled" disabled="disabled">
								Submit
							</button>
						</form>
					</div>
				</div>
				<div id="totpPnl" class="panel panel-default dnone">
					<div class="panel-heading">
				    	<h3 class="panel-title"><a href="/network">Secondary Authentication</a></h3>
			  		</div>
					<div class="panel-body">
						<form id="totpFrm" method='post' enctype='multipart/form-data' autocomplete='off'>	
							<div id="totpStatus" class="alert alert-danger" role="alert">
						    	<strong>TOTP Status:</strong>&nbsp;<span>Deactivated</span>
						    </div>
							<div class="form-group">
								<div class="formCtrl">
									<label for="totpEnabled">Enable TOTP</label>
									<input type="checkbox" class="form-control" id="totpEnabled" name="totpEnabled" >
								</div>
								<a role="button" tabindex="2" data-trigger="focus" class="info" data-po="po" title="Enable TOTP" data-placement="bottom" data-html="true" data-content="Enable / disable TOTP secondary authentication.<br/><br/>This option enables an RFC6238 implementation of TOTP that is compatible with Google Authenticator and other applications that support RFC6238. OTP only works on this device when NTP is switched on since calculating an RFC6238 one time password is a time dependent function.<br/><br/>See&nbsp;<a href='https://en.wikipedia.org/wiki/Time-based_One-time_Password_Algorithm' target='_blank'>Time-based_One-time_Password_Algorithm</a>&nbsp;for details"> <span>i</span> </a>
							</div>							
							<div id="totpConfirm" class="dnone">							
								<div class="form-group">
									<div class="formCtrl">
										<label>TOTP QR Code</label>
										<canvas id="qrCode" class="form-control totpQrCode" width="225" height="225" />							
									</div>
									<a role="button" tabindex="3" data-trigger="focus" class="info" data-po="po" title="TOTP QR Code" data-placement="bottom" data-content="The TOTP QR code to scan into Google Authenticator"> <span>i</span> </a>							    
								</div>
								<div class="form-group">
									<div class="formCtrl">
										<label for="totp">TOTP Confirm</label>
										<input type="password" class="form-control number" id="totp" name="totp" maxlength="6" autocomplete="off" >
									</div>
									<a role="button" tabindex="4" data-trigger="focus" class="info" data-po="po" title="TOTP Confirm" data-placement="bottom" data-html="true" data-content="After adding the TOTP QR code to Google Authenticator, confirm activation with a one-time password here to activate TOTP on this device.<br/><br/>Once activated, a TOTP will be required every time you logon to this device."> <span>i</span> </a>								    
								</div>
							</div>
							<button type="button" class="btn btn-default disabled" disabled="disabled">
								Submit
							</button>
						</form>	
					</div>
				</div>
			</div>
		</div>
		<script src="js/jquery-2.2.0.min.js"></script>
		<script src="js/bootstrap.min.js"></script>		
		<script src="js/jquery.complexify.banlist.js"></script>
		<script src="js/jquery.complexify.js"></script>
		<script src="js/jquery.mask.min.js"></script>
		<script src="js/jquery-qrcode.js"></script>
		<script src="js/password.js"></script>
	</body>
</html>
